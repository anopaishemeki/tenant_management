<!DOCTYPE html>
<html lang="en">
<head>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
 <h5>Generate key</h5>

    <div class="mb-3">
        <label for="num_users" class="form-label">Users</label>
        <input type="number" class="form-control" id="num_users" aria-describedby="emailHelp">

    </div>
    <div class="mb-3">
        <label for="period" class="form-label">period (months)</label>
        <input type="number" class="form-control" id="period">
    </div>

    <button onclick="generate()" class="btn btn-primary">Generate</button>

 <h5>Get Key</h5>
 <div class="mb-3">
     <label for="id" class="form-label">id</label>
     <input type="number" class="form-control" id="id" aria-describedby="emailHelp">
     <input type="email" class="form-control" id="email">
     <button onclick="getkey()" class="btn btn-primary">get key</button>
     <h6>your key:</h6><textarea id="encID">

</textarea>

 </div>
 <script>

 </script>

 <script>

     function SetLocal(token) {
         localStorage.removeItem("token");

         localStorage.setItem("token", JSON.stringify(token));


     }
     function getkey() {
         var id=document.getElementById("id").value;
         var d=document.getElementById("encID");
         var email=document.getElementById("email").value;

         $.ajax({
             url: 'http://localhost:8090/api/v1/get_product/'+id,
             type: 'GET',
             success: function (response) {
                 d.value=response;
                 SetLocal(response);
                 console.log(response);
             }})

             let msg =JSON.parse(localStorage.getItem("token"));
             console.log("Message",msg)
             var tempParams={
                 from_name:"New World",
                 to_email:email,
                 message:msg,

             };
             emailjs.send('gmail','template_ebstv7l',tempParams)
                 .then(function(res){
                     console.log("success",res);

                 })
                 .catch(function(error) {
                     console.error("Error  : ", error);
                 })



     }


     function generate() {
         console.log("generating");
       var num_users=document.getElementById("num_users").value;
       var period=document.getElementById("period").value;

         let data = {
             num_users,
             period
         }
         $.ajax({
             url: 'http://localhost:8090/api/v1/savedetails',
             type: 'POST',
             crossDomain: "true",
             contentType: "application/json; charset=utf-8",
             data: JSON.stringify(data),
             success: function (response) {
                 console.log(response);
             }
         })
     }
 </script>
 <script src="../../js/jquery.min.js"></script>
 <script src="../../js/popper.min.js"></script>
 <script src="../../js/moment.min.js"></script>
 <script src="../../js/bootstrap.min.js"></script>
 <script src="../../js/simplebar.min.js"></script>
 <script src="../../js/downloadfile.js"></script>
 <script src='../../js/daterangepicker.js'></script>
 <script src='../../js/jquery.stickOnScroll.js'></script>
 <script src='../../js/select2.min.js'></script>
 <script src="../../js/tinycolor-min.js"></script>
 <script src="../../js/config.js"></script>
 <script src="../../js/apps.js"></script>


 <script src="../../js/email.min.js"></script>
 <script type="text/javascript">
     (function () {
         emailjs.init("D-bkYkdt8KPF0Wdop");
     })();
 </script>
</body>
</html>